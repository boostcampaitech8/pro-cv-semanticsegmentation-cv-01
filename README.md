# ğŸ¦´ Hand Bone Semantic Segmentation (CV-01)

ë³¸ í”„ë¡œì íŠ¸ëŠ” ì† ì—‘ìŠ¤ë ˆì´(Hand X-ray) ì˜ìƒì—ì„œ 29ì¢…ì˜ ì£¼ìš” ë³¸(Bone) ì˜ì—­ì„ ì •ë°€í•˜ê²Œ ë¶„í• í•˜ëŠ” ì˜ë£Œ ì˜ìƒ ì„¸ê·¸ë©˜í…Œì´ì…˜ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

---

## ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡° (Directory Structure)

```text
.
â”œâ”€â”€ checkpoints/         # ëª¨ë¸ ê°€ì¤‘ì¹˜ ì €ì¥ ë° ê´€ë¦¬
â”‚   â””â”€â”€ LBH_004_nnUNetv2_512_25e/  # ì‹¤í—˜ë³„ ì²´í¬í¬ì¸íŠ¸
â”œâ”€â”€ dataset/             # ë°ì´í„°ì…‹ ë¡œë“œ ë° ì „ì²˜ë¦¬ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ dataset.py          # ê¸°ë³¸ ë°ì´í„°ì…‹ ë¡œë”
â”‚   â”œâ”€â”€ dataset_exclude.py  # Artifact(ê¸ˆì† ë“±) ì œì™¸ ë¡œì§ í¬í•¨ ë¡œë”
â”‚   â””â”€â”€ dataset_xnormalize.py # ë‹¤ì–‘í•œ ì •ê·œí™” ì‹¤í—˜ìš© ë¡œë”
â”œâ”€â”€ eda/                 # íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ (EDA)
â”‚   â”œâ”€â”€ EDA.ipynb           # ê¸°ë³¸ ì´ë¯¸ì§€ ë° ë¼ë²¨ ë¶„ì„
â”‚   â”œâ”€â”€ eda_meta.ipynb      # í™˜ì ë©”íƒ€ë°ì´í„° ë¶„ì„
â”‚   â”œâ”€â”€ fiftyone.ipynb      # Fiftyoneì„ í™œìš©í•œ ë°ì´í„° ì‹œê°í™”
â”‚   â””â”€â”€ EDA_Img_processing.ipynb # ì´ë¯¸ì§€ ì „ì²˜ë¦¬ ë° ì •ë ¬ ë¶„ì„
â”œâ”€â”€ model/               # ëª¨ë¸ ì •ì˜ ëª¨ë“ˆ (Architectures)
â”‚   â”œâ”€â”€ model_unet.py        # Baseline UNet
â”‚   â”œâ”€â”€ model_unet++.py      # Unet++
â”‚   â”œâ”€â”€ model_nnunet.py      # nnUNetv2 (Residual 2D Implementation)
â”‚   â”œâ”€â”€ model_fcn.py         # FCN
â”‚   â”œâ”€â”€ model_deeplabv3plus.py # DeepLabV3+
â”‚   â”œâ”€â”€ model_manet.py       # MAnet
â”‚   â””â”€â”€ model_segformer.py   # SegFormer
â”œâ”€â”€ inference/           # ì¶”ë¡  ë° ê²°ê³¼ ìƒì„±
â”‚   â””â”€â”€ inference.py        # RLE ì¸ì½”ë”© ë° submission.csv ìƒì„±
â”œâ”€â”€ config.py            # [Control Center] ëª¨ë“  ì‹¤í—˜ ì„¤ì • ë° í•˜ì´í¼íŒŒë¼ë¯¸í„°
â”œâ”€â”€ run_exp.py           # [Main Executor] í•™ìŠµ-ì¶”ë¡  ìë™í™” ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ schedule.py          # [Scheduler] ë‹¤ì¤‘ ì‹¤í—˜ ì˜ˆì•½ ë° ìë™ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ train.py             # [Training Engine] ë©”ì¸ í•™ìŠµ ë£¨í”„
â”œâ”€â”€ utils.py             # Loss í•¨ìˆ˜ ë° ê°ì¢… ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ visualize.ipynb      # ì¸í„°ë™í‹°ë¸Œ ê²°ê³¼ ì‹œê°í™”
â””â”€â”€ sample_submission.csv
```

---

## ğŸš€ í”„ë¡œì íŠ¸ í•µì‹¬ ê¸°ëŠ¥ ì„¤ëª…

### ğŸ›  í•µì‹¬ ì‹œìŠ¤í…œ
- **`config.py`**: ëª¨ë“  ì‹¤í—˜ì˜ ì¤‘ì•™ ì œì–´ ì¥ì¹˜ì…ë‹ˆë‹¤. `MODEL_FILE`, `DATASET_FILE`, `LOSS_FUNCTION`, `LR`, `Batch Size` ë“±ì„ ì—¬ê¸°ì„œ í•œ ë²ˆì— ê´€ë¦¬í•©ë‹ˆë‹¤.
- **`run_exp.py`**: `train.py`ì™€ `inference.py`ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤. CLI ì¸ì(`--exp_name`, `--lr` ë“±)ë¥¼ í†µí•´ `config.py` ì„¤ì •ì„ ë™ì ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆì–´ íš¨ìœ¨ì ì¸ ì‹¤í—˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
- **`schedule.py`**: **ë‹¤ì¤‘ ì‹¤í—˜ ìë™í™” ìŠ¤í¬ë¦½íŠ¸**ì…ë‹ˆë‹¤. `experiments` ë¦¬ìŠ¤íŠ¸ì— ì›í•˜ëŠ” ì‹¤í—˜ ì¡°í•©(ëª¨ë¸, ë¡œìŠ¤, ì—í­ ë“±)ì„ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë‚˜ì—´í•˜ë©´, ìˆœì°¨ì ìœ¼ë¡œ `run_exp.py`ë¥¼ í˜¸ì¶œí•˜ì—¬ í•™ìŠµì„ ì§„í–‰í•©ë‹ˆë‹¤. (ìì„¸í•œ ì‚¬ìš©ë²•ì€ í•˜ë‹¨ ì°¸ì¡°)
- **`train.py`**: ì‹¤ì§ˆì ì¸ í•™ìŠµì„ ë‹´ë‹¹í•˜ë©°, `torch.amp`ë¥¼ ì´ìš©í•œ í˜¼í•© ì •ë°€ë„ í•™ìŠµ, WandB ë¡œê¹…, ì„±ëŠ¥ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ìë™ ì €ì¥ ê¸°ëŠ¥ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

### ğŸ± êµ¬ì„± ìš”ì†Œ (Modules)
- **`model/`**: `get_model()` ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ë‹¤ì–‘í•œ ëª¨ë¸ì„ ì¦‰ì‹œ êµì²´í•˜ì—¬ ì‹¤í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
- **`dataset/`**: ì´ë¯¸ì§€ì™€ JSON ë¼ë²¨ì„ ë§¤ì¹­í•˜ê³ , `exclude` ë¡œì§ì„ í†µí•´ ë°ì´í„° í’ˆì§ˆì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
- **`utils.py`**: `DiceLoss`, `FocalLoss`, `TverskyLoss` ë“± ì„¸ê·¸ë©˜í…Œì´ì…˜ì— íŠ¹í™”ëœ ë‹¤ì–‘í•œ Loss í•¨ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

---

## ğŸ›  ì‚¬ìš© ë°©ë²•

### 1. ì„¤ì • ë³€ê²½ (`config.py`)
ê¸°ë³¸ ì‹¤í—˜ íŒŒë¼ë¯¸í„°ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.
```python
MODEL_FILE = 'model.model_nnunet'
EXPERIMENT_NAME = 'nnUNetv2_Training_Run'
```

### 2. ë‹¨ì¼ ì‹¤í—˜ ì‹¤í–‰
```bash
# í•™ìŠµë§Œ ì§„í–‰í•  ê²½ìš°
python train.py

# í•™ìŠµë¶€í„° CSV ìƒì„±ê¹Œì§€ ìë™ ì‹¤í–‰í•  ê²½ìš°
python run_exp.py --exp_name test_run --model_file model.model_nnunet
```

### 3. ë‹¤ì¤‘ ì‹¤í—˜ ìë™í™” (`schedule.py`)
ì—¬ëŸ¬ ì‹¤í—˜ì„ ì˜ˆì•½í•˜ì—¬ ìëŠ” ë™ì•ˆ í˜¹ì€ ë‹¤ë¥¸ ì‘ì—…ì„ í•˜ëŠ” ë™ì•ˆ ìˆœì°¨ì ìœ¼ë¡œ ëŒë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
1. `schedule.py` íŒŒì¼ ë‚´ `experiments` ë¦¬ìŠ¤íŠ¸ì— ì‹¤í—˜ ì„¤ì • ì¶”ê°€
2. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰:
```bash
python schedule.py
```

### 4. ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ ë° ë¡œê·¸ ì €ì¥ (Linux ëª…ë ¹ì–´)
ì„œë²„ ì ‘ì†ì´ ëŠê²¨ë„ í•™ìŠµì´ ìœ ì§€ë˜ë„ë¡ í•˜ê³ , ëª¨ë“  ë¡œê·¸ë¥¼ íŒŒì¼ë¡œ ë‚¨ê¸°ëŠ” ê¶Œì¥ ë°©ë²•ì…ë‹ˆë‹¤.
```bash
# nohupì„ ì´ìš©í•œ ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ (Configì˜ ì‹¤í—˜ëª… + ë‚ ì§œ/ì‹œê°„ ì‚¬ìš©)
EXP_NAME=$(python3 -c 'from config import Config; print(Config.EXPERIMENT_NAME)') && \
nohup python run_exp.py > ${EXP_NAME}_$(date +%Y%m%d_%H%M%S).log 2>&1 &

# ì‹¤ì‹œê°„ìœ¼ë¡œ ë¡œê·¸ í™•ì¸í•˜ê¸° (ê°€ì¥ ìµœê·¼ ìƒì„±ëœ ë¡œê·¸ íŒŒì¼)
tail -f $(ls -t *.log | head -n 1)
```

---

## ğŸ“ˆ ì§„í–‰ í˜„í™© ë° ë¡œë“œë§µ
- [x] **Baselines**: ë‹¤ì–‘í•œ ì„¸ê·¸ë©˜í…Œì´ì…˜ ëª¨ë¸ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ì™„ë£Œ
- [x] **Data Cleaning**: Artifact í¬í•¨ ìƒ˜í”Œ(ID363, ID387 ë“±) í•„í„°ë§ ì ìš©
- [x] **Model Advanced**: nnUNetv2 ì•„í‚¤í…ì²˜ ë„ì… (Mean Dice 0.967+ ë‹¬ì„±)
- [ ] **Preprocessing**: ë¼ˆ ì¢Œí‘œ ê¸°ë°˜ì˜ ì •ë ¬(Alignment) ê³ ë„í™” ì§„í–‰ ì¤‘
- [ ] **Advanced Training**: Deep Supervision ê¸°ë°˜ì˜ Loss ê°€ì¤‘ì¹˜ ìµœì í™”

---

## ğŸ‘¥ íŒ€ ì •ë³´
- **Team**: Boostcamp AI Tech 8ê¸° CV-01
- **Focus**: Precision Medical Image Segmentation
